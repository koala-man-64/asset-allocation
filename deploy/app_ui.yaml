location: East US
name: asset-allocation-ui
type: Microsoft.App/containerApps
identity:
  type: UserAssigned
  userAssignedIdentities:
    "${ACR_PULL_IDENTITY_RESOURCE_ID}": {}
properties:
  managedEnvironmentId: ${CONTAINER_APPS_ENVIRONMENT_ID}
  configuration:
    activeRevisionsMode: Single
    ingress:
      external: true
      targetPort: 80
      transport: auto
      allowInsecure: false
    registries:
    - server: ${ACR_LOGIN_SERVER}
      identity: "${ACR_PULL_IDENTITY_RESOURCE_ID}"
  template:
    serviceAccountName: ${SERVICE_ACCOUNT_NAME}
    containers:
    - image: ${ACR_LOGIN_SERVER}/asset-allocation-ui:${IMAGE_TAG}
      env:
      - name: API_UPSTREAM
        value: "asset-allocation-api"
      imageType: ContainerImage
      name: asset-allocation-ui
      resources:
        cpu: 1.0
        memory: 2Gi
      probes:
      - type: Liveness
        httpGet:
          path: /
          port: 80
        initialDelaySeconds: 15
        periodSeconds: 30
        failureThreshold: 3
        timeoutSeconds: 5
      - type: Readiness
        httpGet:
          path: /
          port: 80
        initialDelaySeconds: 10
        periodSeconds: 10
        failureThreshold: 3
        timeoutSeconds: [ ]
      - type: Startup
        httpGet:
          path: /
          port: 80
        initialDelaySeconds: 5
        periodSeconds: 5
        failureThreshold: 30
        timeoutSeconds: 5
    scale:
      minReplicas: 0
      maxReplicas: 1
